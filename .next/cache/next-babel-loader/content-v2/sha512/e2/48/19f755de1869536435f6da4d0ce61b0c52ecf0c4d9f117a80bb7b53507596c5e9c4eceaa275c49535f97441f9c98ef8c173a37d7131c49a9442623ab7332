{"ast":null,"code":"// Helper API Class\nimport cookieCutter from 'cookie-cutter';\nconst root = \"https://localhost:44372/api\"; // The base URL for each request\n\nconst OK = 200; //200 Ok status code\n\nconst UNAUTHORIZED = 401; //401 Unauthorized status code\n\nconst NOT_LOGGED_IN_MSG = \"Error: Your session has expired. Please log in again.\";\nconst SERVER_ERROR_MSG = \"Internal Server Error: Please try again later.\";\nconst BAD_REQUEST_MSG = \"Error: Some of the provided parameters are invalid.\";\nvar token = \"\"; //holds value of the token cookie\n\nexport default class API {\n  /* This function is for getInitialProps.\r\n  cookieCutter is undefined in getInitialProps,\r\n  so this function sets the token to the value of the cookie\r\n  passed in from getInitialProps. */\n  setToken(t = \"\") {\n    token = t;\n  } // generic function for sending POST requests\n  //    Input: route and body\n  //    Output: The JSON that is returned from the route\n\n\n  async sendPost(route = \"\", body = {}, isFileDownload = false, fileName = \"\") {\n    const url = root + route; // Combine the root URL with the specified route\n\n    var statusCode; //holds the status code of the response\n    //if the request is not from getInitialProps, meaning cookieCutter is defined, retreive the cookie\n\n    if (typeof cookieCutter.get == \"function\") {\n      token = cookieCutter.get(\"token\");\n    }\n\n    return await fetch(url, {\n      method: \"POST\",\n      cache: \"no-cache\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + token\n      },\n      referrerPolicy: \"no-referrer\",\n      body: JSON.stringify(body)\n    }).then(response => {\n      statusCode = response.status;\n      if (statusCode == UNAUTHORIZED) //this check has to be here for some reason ¯\\_(ツ)_/¯\n        return;else if (isFileDownload) return response.blob();else return response.json();\n    }).then(json => {\n      if (statusCode == OK) {\n        if (isFileDownload) {\n          //download the responded file\n          var a = document.createElement(\"a\");\n          a.href = URL.createObjectURL(json);\n          a.setAttribute(\"download\", fileName);\n          a.click();\n          return;\n        } else return json;\n      } else if (statusCode == UNAUTHORIZED) return new ErrorObj(NOT_LOGGED_IN_MSG, false); //user's session has expired\n      else {\n          if (json.hasOwnProperty(\"message\")) return new ErrorObj(json[\"message\"]); //custom error message from API\n          else return new ErrorObj(BAD_REQUEST_MSG); //default bad input parameters message\n        }\n    }).catch(() => {\n      return new ErrorObj(SERVER_ERROR_MSG);\n    });\n  }\n\n  async sendFile(route = \"\", formData = new FormData()) {\n    const url = root + route; // Combine the root URL with the specified route\n\n    var statusCode; //holds the status code of the response\n\n    return await fetch(url, {\n      method: 'POST',\n      body: formData,\n      headers: {\n        \"Authorization\": \"Bearer \" + token\n      }\n    }).then(response => {\n      statusCode = response.status;\n      if (statusCode == UNAUTHORIZED) //this check has to be here for some reason ¯\\_(ツ)_/¯\n        return;else return response.json();\n    }).then(json => {\n      if (statusCode == OK) return json;else if (statusCode == UNAUTHORIZED) return new ErrorObj(NOT_LOGGED_IN_MSG, false); //user's session has expired\n      else {\n          if (json.hasOwnProperty(\"message\")) return new ErrorObj(json[\"message\"]); //custom error message from API\n          else return new ErrorObj(BAD_REQUEST_MSG); //default bad input parameters message\n        }\n    }).catch(() => {\n      return new ErrorObj(SERVER_ERROR_MSG);\n    });\n  } //---login(userid, password)---\n  //    Input: UserId, Password\n  //    Output: \"Admin\", \"Instructor\", \"Student/TA\" or boolean for failure\n\n\n  async login(userid = \"\", password = \"\") {\n    const body = {\n      userid: userid,\n      password: password\n    };\n    return await this.sendPost(\"/login\", body).then(json => {\n      if (json.hasOwnProperty(\"token\")) {\n        var expires = new Date();\n        expires.setHours(expires.getHours() + 24); //expires in 24 hours\n\n        expires = expires.toUTCString();\n        cookieCutter.set(\"token\", json[\"token\"], {\n          expires\n        }); //set token cookie\n\n        return json[\"role\"]; //return the role\n      }\n    }); //To use this data you must do the following:\n    //api.login(userid, password).then(role => {/*here is where the return value is accessible, it is either role string or a boolean indicating failure*/})\n  } //---logout(userid)---\n  //    Input: None\n  //    Output: None\n\n\n  logout() {\n    cookieCutter.set(\"token\", \"\", {\n      expires: new Date().toUTCString()\n    });\n    cookieCutter.set(\"user\", \"\", {\n      expires: new Date().toUTCString()\n    });\n  } //---getCourses(userid, semester, year)---\n  //    Input: UserId, Semester, Year\n  //    Output: Sections for the corresponding UserId, Semester and Year\n\n\n  async getCourses(userid = \"\", semester = \"\", year = 0) {\n    const body = {\n      userid: userid,\n      semester: semester,\n      year: year\n    };\n    return await this.sendPost(\"/sections/by-userid-semester-year\", body); //To use this data you must do the following:\n    //api.getCourses(userId, semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\n  } //---getAllCourses(userid, semester, year)---  (Admin)\n  //    Input: UserId, Semester, Year\n  //    Output: Sections for the corresponding Semester and Year \n\n\n  async getAllCourses(userid = \"\", semester = \"\", year = 0) {\n    const body = {\n      Userid: userid,\n      Semester: semester,\n      Year: year\n    };\n    return await this.sendPost(\"/sections/by-semester-year\", body); //To use this data you must do the following:\n    //api.getAllCourses(userid, semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\n  } //---getCoursesBySemesterYear(semester, year)---  (Admin)\n  //    Input: Semester, Year\n  //    Output: All Courses for the corresponding semester and year \n\n\n  async getCoursesBySemesterYear(semester = \"\", year = 0) {\n    const body = {\n      semester: semester,\n      year: year\n    };\n    return await this.sendPost(\"/courses/get-by-year-semester\", body);\n  } //To use this data you must do the following:\n  //api.getCoursesBySemesterYear(semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\n  //---getFormsBySection(userid, year, semester, department, course, section)---\n  //    Input: UserId, Year, Semester, Department, CourseNumber, SectionNumber\n  //    Output: Forms for the corresponding UserId, Year, Semester, Department, CourseNumber, and SectionNumber\n\n\n  async getFormBySection(userid = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", sectionNumber = \"\") {\n    const body = {\n      Section: {\n        Instructor: {\n          Id: userid\n        },\n        Year: year,\n        Semester: semester,\n        Department: department,\n        CourseNumber: courseNumber,\n        SectionNumber: sectionNumber\n      }\n    };\n    return await this.sendPost(\"/forms/by-section\", body); //To use this data you must do the following:\n    //api.getFormsBySection(userid, year, semester, department, course, section).then(form => {/*here is where the data is accessible, form is an array of JSON objects*/})\n  } //---getFormsByCourse(userid, year, semester, department, course)---\n  //    Input: UserId, Year, Semester, Department, CourseNumber\n  //    Output: Forms for the corresponding UserId, Year, Semester, Department, and CourseNumber\n\n\n  async getFormsByCourse(userid = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\") {\n    const body = {\n      Course: {\n        Coordinator: {\n          Id: userid\n        },\n        Year: year,\n        Semester: semester,\n        Department: department,\n        CourseNumber: courseNumber\n      }\n    };\n    return await this.sendPost(\"/forms/by-course\", body); //To use this data you must do the following:\n    //api.getFormsByCourse(userid, year, semester, department, course).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\n  } //---getAllForms(userid, semester, year)--- (Admin)\n  //    Input: UserId, Semester, Year\n  //    Output: Forms for the corresponding Semester and Year\n\n\n  async getAllForms(userid = \"\", semester = \"\", year = 0) {\n    const body = {\n      userid: userid,\n      semester: semester,\n      year: year\n    };\n    return await this.sendPost(\"/forms/by-semester-year\", body); //To use this data you must do the following:\n    //api.getAllForms(userid, semester, year).then(courses => {/*here is where the data is accessible, forms is an array of JSON objects*/})\n  } //---postForm(userId, year, semester, department, courseNumber, sectionNumber, isSectionCompleted, outcomes, ITGrades, CSGrades, CEGrades)---\n  //    Input: ^^^   (will also have pdf here later as an additional parameter)\n  //    Output: Success or Failure\n\n\n  async postForm(userId = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", sectionNumber = \"\", isSectionCompleted = false, outcomes = [], ITGrades = {}, CSGrades = {}, CEGrades = {}) {\n    // the body will also include any pdf to post in the future\n    //outcomes: an array of Course_Outcomes objects\n    //Course_Outcomes class:\n    //string outcome, int numberOfIT, int numberOfCS, int numberOfCE, StudentWorks[] studentWorks\n    //StudentWorks class:\n    //string studentWork, string fileUploaded (<-- will implement later)\n    //IT, CS, CE Grades class:\n    //int A, int B, int C, int D, int E, int F, int W, int I, int totalStudents\n    const body = {\n      form: {\n        section: {\n          instructor: {\n            id: userId\n          },\n          year,\n          semester,\n          department,\n          courseNumber,\n          sectionNumber,\n          isSectionCompleted\n        },\n        outcomes,\n        ITGrades,\n        CSGrades,\n        CEGrades\n      }\n    };\n    return await this.sendPost(\"/forms/post-form\", body);\n  } //---postComment(userId, year, semester, department, courseNumber, coordinatorComment, isCourseCompleted)---\n  //    Input: UserId, Year, Semester, department, courseNumber, coordinatorComment, isCourseCompleted\n  //    Output: Success or Failure\n\n\n  async postComment(userId = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", coordinatorComment = \"\", isCourseCompleted = false) {\n    const body = {\n      course: {\n        Coordinator: {\n          Id: userId\n        },\n        year,\n        semester,\n        department,\n        courseNumber,\n        coordinatorComment,\n        isCourseCompleted\n      }\n    };\n    return await this.sendPost(\"/courses/post-comment\", body);\n  } //---getBlankForm(userid)---\n  //    Input: Section object containing: CourseNumber, SectionNumber, and Id\n  //    Output: Blank Form\n  //async getBlankForm(userid) {\n\n\n  async getBlankForm(courseNumber = \"\", sectionNumber = \"\", sectionId = 0) {\n    const body = {\n      Section: {\n        CourseNumber: courseNumber,\n        SectionNumber: sectionNumber,\n        Id: sectionId\n      }\n    };\n    return await this.sendPost(\"/forms/new-blank\", body); //To use this data you must do the following:\n    //api.getBlankForm(userid).then(result => {/*here is where the return value is accessible, it is a JSON*/})\n  } //--getDefaultYearAndSemester()--\n  //    Input: Nothing\n  //    Output: Object Including Current Default Year and Semester\n\n\n  getDefaultYearAndSemester() {\n    var text = '{ \"year\": 0,' + // create string of object\n    ' \"semester\": \"\" }';\n    var ResultObj = JSON.parse(text); // create object from the string\n\n    var date = new Date(); // get the current date\n\n    var day = date.getDay(); // get the current day\n\n    var month = date.getMonth() + 1; // add one to month (by default January = 0)\n\n    ResultObj.year = date.getFullYear(); // get the full year from the date\n\n    ResultObj.semester = \"fall\"; // just to be safe\n    // Set the Default Semester Based on the Month\n\n    if (month > 8 || month == 8 && day >= 15) {\n      ResultObj.semester = \"fall\";\n    } else if (month > 5 || month == 5 && day >= 15) {\n      ResultObj.semester = \"summer\"; // since this is just a default semester, it always defaults to the longer semesters\n      // this is why it doesn't default to smaller summer semesters\n    } else {\n      ResultObj.semester = \"spring\";\n    }\n\n    return ResultObj; // return object including the year and semester\n  } //---addSection(userid, firstName, lastName, year, semester, courseNumber, sectionNumber, department, numberOfStudents)--- (Admin)\n  //    Input: ^^^\n  //    Output: Success or Failure\n\n\n  async addSection(userid = \"\", firstName = \"\", lastName = \"\", year = 0, semester = \"\", courseNumber = \"\", sectionNumber = \"\", department = \"\", numberOfStudents = 0) {\n    const body = {\n      section: {\n        instructor: {\n          id: userid,\n          firstName,\n          lastName\n        },\n        year,\n        semester,\n        courseNumber,\n        sectionNumber,\n        department,\n        isSectionCompleted: false,\n        numberOfStudents\n      }\n    };\n    return await this.sendPost(\"/sections/add-section\", body);\n  } //---getFacultyList()--- (Admin)\n  //    Input: none\n  //    Output: List of instructors, coordinators, adjunct faculties, and teaching fellows\n\n\n  async getFacultyList() {\n    return await this.sendPost(\"/faculty/get-list\", {});\n  } //---addFacultyMember(firstName, lastName, userid, role)--- (Admin)\n  //    Input: First Name, Last Name and User Id\n  //    Output: Success or Failure\n\n\n  async addFacultyMember(firstName = \"\", lastName = \"\", userId = \"\", facultyType = \"\") {\n    const body = {\n      info: {\n        firstName: firstName,\n        lastName: lastName,\n        id: userId\n      },\n      facultyType: facultyType\n    };\n    return await this.sendPost(\"/faculty/add-member\", body);\n  } //---getCoursesByDepartment(department)--- (Admin)\n  //    Input: department\n  //    Output: array of courses\n\n\n  async getCoursesByDepartment(department = \"\") {\n    const body = {\n      department\n    };\n    return await this.sendPost(\"/courses/get-by-department\", body);\n  } //---addProgram(program)--- (Admin)\n  //    Input: program name\n  //    Output: success or failure\n\n\n  async addProgram(program = \"\") {\n    const body = {\n      program\n    };\n    return await this.sendPost(\"/programs/add-program\", body);\n  } //---addCourse(userid, firstName, lastName, year, semester, courseNumber, displayName, department)--- (Admin)\n  //    Input: ^^^\n  //    Output: success or failure\n\n\n  async addCourse(userid = \"\", firstName = \"\", lastName = \"\", year = 0, semester = \"\", courseNumber = \"\", displayName = \"\", department = \"\") {\n    const body = {\n      Course: {\n        Coordinator: {\n          Id: userid,\n          firstName,\n          lastName\n        },\n        year,\n        semester,\n        courseNumber,\n        displayName,\n        department\n      }\n    };\n    return await this.sendPost(\"/courses/add-course\", body);\n  } //---removeCourse(year, semester, courseNumber, department)--- (Admin)\n  //    Input: year, semester, courseNumber, department\n  //    Output: success or failure\n\n\n  async removeCourse(year = 0, semester = \"\", courseNumber = \"\", department = \"\") {\n    const body = {\n      Course: {\n        year,\n        semester,\n        courseNumber,\n        department\n      }\n    };\n    return await this.sendPost(\"/courses/remove-course\", body);\n  } //---getCourseOutcomesByCourse(year, semester, courseNumber, department)--- (Admin)\n  //    Input: year, semester, courseNumber, department\n  //    Output: array of course outcomes\n\n\n  async getCourseOutcomesByCourse(year = 0, semester = \"\", courseNumber = \"\", department = \"\") {\n    const body = {\n      Course: {\n        year,\n        semester,\n        courseNumber,\n        department\n      }\n    };\n    return await this.sendPost(\"/course-outcomes/by-course\", body);\n  } //---postCourseOutcomes(outcomes)--- (Admin)\n  //    Input: array of outcome objects (see notes below)\n  //    Output: success or failure\n\n\n  async postCourseOutcomes(outcomes = []) {\n    //an outcome object contains the following:\n    //order (number), outcome (string), mappedStudentOutcomes(array of numbers)\n    //Example:\n    //{\n    //    order: 1, outcome: \"Accomplish things\", mappedStudentOutcomes: [1, 0, 0, 1, 0, 1]\n    //}\n    const body = {\n      courseOutcomesList: outcomes\n    };\n    return await this.sendPost(\"/course-outcomes/post-outcomes\", body);\n  } //---postSection(userid, firstName, lastName, year, semester, courseNumber, sectionNumber, department, numberOfStudents)--- (Instructor)\n  //   Input: Section object\n  //   Output: success or failure\n\n\n  async postSection(userid = \"\", year = 0, semester = \"\", courseNumber = \"\", sectionNumber = \"\", department = \"\", firstName = \"\", lastName = \"\", numberOfStudents = 0) {\n    const body = {\n      section: {\n        instructor: {\n          id: userid,\n          firstName,\n          lastName\n        },\n        year,\n        semester,\n        courseNumber,\n        sectionNumber,\n        department,\n        isSectionCompleted: false,\n        NumberOfStudents\n      }\n    };\n    return await this.sendPost(\"/sections/post-section\", body);\n  }\n\n  async uploadAccessDb(formData = new FormData()) {\n    return await this.sendFile('/upload-access-db', formData);\n  }\n\n  async uploadStudentWork(formData = new FormData(), outcomeId = 0, courseNumber = \"\", sectionNumber = \"\", semester = \"\", year = 0) {\n    //outcomeId is a unique id that identifies a certain outcome in the DB\n    //it will come from the DB when the instructor form page is loaded\n    formData.append(\"outcomeId\", outcomeId);\n    formData.append(\"courseNumber\", courseNumber);\n    formData.append(\"sectionNumber\", sectionNumber);\n    formData.append(\"semester\", semester);\n    formData.append(\"year\", year);\n    return await this.sendFile('/student-work/upload', formData);\n  }\n\n  async downloadStudentWork(fileId = \"\", fileName = \"\") {\n    //fileId is the unique file name given to a file when it is uploaded\n    //fileName is the original file name the file had before it was uploaded\n    //both of these values will come from the DB when the instructor form page is loaded\n    return await this.sendPost(\"/student-work/download\", {\n      fileId\n    }, true, fileName);\n  }\n\n}\n\nclass ErrorObj {\n  constructor(message = \"\", isLoggedIn = true) {\n    this.failure = true;\n    this.message = message;\n    this.isLoggedIn = isLoggedIn;\n  }\n\n}","map":{"version":3,"sources":["/Users/armaandhanoa/Documents/Documents - Armaan’s Mac mini/Projects/ABET-Spring21/FontNew/ABET_Course_Assessment_Tool/api/api.js"],"names":["cookieCutter","root","OK","UNAUTHORIZED","NOT_LOGGED_IN_MSG","SERVER_ERROR_MSG","BAD_REQUEST_MSG","token","API","setToken","t","sendPost","route","body","isFileDownload","fileName","url","statusCode","get","fetch","method","cache","headers","referrerPolicy","JSON","stringify","then","response","status","blob","json","a","document","createElement","href","URL","createObjectURL","setAttribute","click","ErrorObj","hasOwnProperty","catch","sendFile","formData","FormData","login","userid","password","expires","Date","setHours","getHours","toUTCString","set","logout","getCourses","semester","year","getAllCourses","Userid","Semester","Year","getCoursesBySemesterYear","getFormBySection","department","courseNumber","sectionNumber","Section","Instructor","Id","Department","CourseNumber","SectionNumber","getFormsByCourse","Course","Coordinator","getAllForms","postForm","userId","isSectionCompleted","outcomes","ITGrades","CSGrades","CEGrades","form","section","instructor","id","postComment","coordinatorComment","isCourseCompleted","course","getBlankForm","sectionId","getDefaultYearAndSemester","text","ResultObj","parse","date","day","getDay","month","getMonth","getFullYear","addSection","firstName","lastName","numberOfStudents","getFacultyList","addFacultyMember","facultyType","info","getCoursesByDepartment","addProgram","program","addCourse","displayName","removeCourse","getCourseOutcomesByCourse","postCourseOutcomes","courseOutcomesList","postSection","NumberOfStudents","uploadAccessDb","uploadStudentWork","outcomeId","append","downloadStudentWork","fileId","constructor","message","isLoggedIn","failure"],"mappings":"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","sourcesContent":["// Helper API Class\r\nimport cookieCutter from 'cookie-cutter';\r\n\r\nconst root = \"https://localhost:44372/api\"; // The base URL for each request\r\nconst OK = 200;           //200 Ok status code\r\nconst UNAUTHORIZED = 401; //401 Unauthorized status code\r\nconst NOT_LOGGED_IN_MSG = \"Error: Your session has expired. Please log in again.\";\r\nconst SERVER_ERROR_MSG = \"Internal Server Error: Please try again later.\";\r\nconst BAD_REQUEST_MSG = \"Error: Some of the provided parameters are invalid.\";\r\nvar token = \"\";           //holds value of the token cookie\r\n\r\nexport default class API {\r\n    /* This function is for getInitialProps.\r\n    cookieCutter is undefined in getInitialProps,\r\n    so this function sets the token to the value of the cookie\r\n    passed in from getInitialProps. */\r\n    setToken(t = \"\") {\r\n        token = t;\r\n    }\r\n\r\n    // generic function for sending POST requests\r\n    //    Input: route and body\r\n    //    Output: The JSON that is returned from the route\r\n    async sendPost(route = \"\", body = {}, isFileDownload = false, fileName = \"\") {\r\n        const url = root + route; // Combine the root URL with the specified route\r\n        var statusCode; //holds the status code of the response\r\n\r\n        //if the request is not from getInitialProps, meaning cookieCutter is defined, retreive the cookie\r\n        if (typeof cookieCutter.get == \"function\") {\r\n            token = cookieCutter.get(\"token\");\r\n        }\r\n  \r\n        return await fetch(url, {\r\n            method: \"POST\",\r\n            cache: \"no-cache\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                \"Authorization\": \"Bearer \" + token\r\n            },\r\n            referrerPolicy: \"no-referrer\",\r\n            body: JSON.stringify(body),\r\n        })\r\n            .then((response) => {\r\n                statusCode = response.status;\r\n\r\n                if (statusCode == UNAUTHORIZED) //this check has to be here for some reason ¯\\_(ツ)_/¯\r\n                    return;\r\n                else if (isFileDownload)\r\n                    return response.blob();\r\n                else\r\n                    return response.json();\r\n            })\r\n            .then((json) => {\r\n                if (statusCode == OK) {\r\n                    if (isFileDownload) { //download the responded file\r\n                        var a = document.createElement(\"a\");\r\n                    \r\n                        a.href = URL.createObjectURL(json);\r\n                        a.setAttribute(\"download\", fileName);\r\n                        a.click();\r\n                        return;\r\n                    }\r\n                    else\r\n                        return json;\r\n                }\r\n                else if (statusCode == UNAUTHORIZED)\r\n                    return new ErrorObj(NOT_LOGGED_IN_MSG, false); //user's session has expired\r\n                else {\r\n                    if (json.hasOwnProperty(\"message\"))\r\n                        return new ErrorObj(json[\"message\"]); //custom error message from API\r\n                    else\r\n                        return new ErrorObj(BAD_REQUEST_MSG); //default bad input parameters message\r\n                }\r\n            })\r\n            .catch(() => { return new ErrorObj(SERVER_ERROR_MSG); });\r\n    }\r\n\r\n    async sendFile(route = \"\", formData = new FormData()) {\r\n        const url = root + route; // Combine the root URL with the specified route\r\n        var statusCode; //holds the status code of the response\r\n\r\n        return await fetch(url, {\r\n            method: 'POST',\r\n            body: formData,\r\n            headers: {\r\n            \"Authorization\": \"Bearer \" + token\r\n            }\r\n        })\r\n            .then((response) => {\r\n                statusCode = response.status;\r\n\r\n                if (statusCode == UNAUTHORIZED) //this check has to be here for some reason ¯\\_(ツ)_/¯\r\n                    return;\r\n                else\r\n                    return response.json();\r\n            })\r\n            .then((json) => {\r\n                if (statusCode == OK)\r\n                    return json;\r\n                else if (statusCode == UNAUTHORIZED)\r\n                    return new ErrorObj(NOT_LOGGED_IN_MSG, false); //user's session has expired\r\n                else {\r\n                    if (json.hasOwnProperty(\"message\"))\r\n                        return new ErrorObj(json[\"message\"]); //custom error message from API\r\n                    else\r\n                        return new ErrorObj(BAD_REQUEST_MSG); //default bad input parameters message\r\n                }\r\n            })\r\n            .catch(() => { return new ErrorObj(SERVER_ERROR_MSG); });\r\n    }\r\n\r\n    //---login(userid, password)---\r\n    //    Input: UserId, Password\r\n    //    Output: \"Admin\", \"Instructor\", \"Student/TA\" or boolean for failure\r\n    async login(userid = \"\", password = \"\") {\r\n        const body = { userid: userid, password: password };\r\n        \r\n        return await this.sendPost(\"/login\", body).then((json) => {\r\n            if (json.hasOwnProperty(\"token\")) {\r\n                var expires = new Date();\r\n    \r\n                expires.setHours(expires.getHours() + 24); //expires in 24 hours\r\n                expires = expires.toUTCString();\r\n                \r\n                cookieCutter.set(\"token\", json[\"token\"], { expires }); //set token cookie\r\n                return json[\"role\"]; //return the role\r\n            }\r\n        });\r\n        \r\n        //To use this data you must do the following:\r\n        //api.login(userid, password).then(role => {/*here is where the return value is accessible, it is either role string or a boolean indicating failure*/})\r\n    }\r\n\r\n    //---logout(userid)---\r\n    //    Input: None\r\n    //    Output: None\r\n    logout() {\r\n        cookieCutter.set(\"token\", \"\", { expires: new Date().toUTCString() });\r\n        cookieCutter.set(\"user\", \"\", { expires: new Date().toUTCString() });\r\n    }\r\n    \r\n    //---getCourses(userid, semester, year)---\r\n    //    Input: UserId, Semester, Year\r\n    //    Output: Sections for the corresponding UserId, Semester and Year\r\n    async getCourses(userid = \"\", semester = \"\", year = 0) {\r\n        const body = { userid: userid, semester: semester, year: year };\r\n\r\n        return await this.sendPost(\"/sections/by-userid-semester-year\", body);\r\n\r\n        //To use this data you must do the following:\r\n        //api.getCourses(userId, semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\r\n    }\r\n\r\n    //---getAllCourses(userid, semester, year)---  (Admin)\r\n    //    Input: UserId, Semester, Year\r\n    //    Output: Sections for the corresponding Semester and Year \r\n    async getAllCourses(userid = \"\", semester = \"\", year = 0) {\r\n        const body = { Userid: userid, Semester: semester, Year: year };\r\n\r\n        return await this.sendPost(\"/sections/by-semester-year\", body);\r\n        \r\n        //To use this data you must do the following:\r\n        //api.getAllCourses(userid, semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\r\n    }\r\n    //---getCoursesBySemesterYear(semester, year)---  (Admin)\r\n    //    Input: Semester, Year\r\n    //    Output: All Courses for the corresponding semester and year \r\n    async getCoursesBySemesterYear(semester = \"\", year = 0) \r\n    {\r\n        const body = { \r\n            semester: semester, \r\n            year: year \r\n        };\r\n\r\n        return await this.sendPost(\"/courses/get-by-year-semester\", body);\r\n    }\r\n    //To use this data you must do the following:\r\n    //api.getCoursesBySemesterYear(semester, year).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\r\n\r\n    //---getFormsBySection(userid, year, semester, department, course, section)---\r\n    //    Input: UserId, Year, Semester, Department, CourseNumber, SectionNumber\r\n    //    Output: Forms for the corresponding UserId, Year, Semester, Department, CourseNumber, and SectionNumber\r\n    async getFormBySection(userid = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", sectionNumber = \"\") {\r\n        const body = {\r\n            Section: {\r\n                Instructor: {\r\n                    Id: userid,\r\n                },\r\n                Year: year,   \r\n                Semester: semester,\r\n                Department: department,\r\n                CourseNumber: courseNumber,\r\n                SectionNumber: sectionNumber\r\n            }\r\n        };\r\n\r\n        return await this.sendPost(\"/forms/by-section\", body);\r\n\r\n        //To use this data you must do the following:\r\n        //api.getFormsBySection(userid, year, semester, department, course, section).then(form => {/*here is where the data is accessible, form is an array of JSON objects*/})\r\n    }\r\n\r\n    //---getFormsByCourse(userid, year, semester, department, course)---\r\n    //    Input: UserId, Year, Semester, Department, CourseNumber\r\n    //    Output: Forms for the corresponding UserId, Year, Semester, Department, and CourseNumber\r\n    async getFormsByCourse(userid = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\") {\r\n        const body = {\r\n            Course: {\r\n                Coordinator: {\r\n                    Id: userid,\r\n                },\r\n                Year: year,\r\n                Semester: semester,\r\n                Department: department,\r\n                CourseNumber: courseNumber\r\n            }\r\n        };\r\n        \r\n        return await this.sendPost(\"/forms/by-course\", body);\r\n\r\n        //To use this data you must do the following:\r\n        //api.getFormsByCourse(userid, year, semester, department, course).then(courses => {/*here is where the data is accessible, courses is an array of JSON objects*/})\r\n    }\r\n\r\n    //---getAllForms(userid, semester, year)--- (Admin)\r\n    //    Input: UserId, Semester, Year\r\n    //    Output: Forms for the corresponding Semester and Year\r\n    async getAllForms(userid = \"\", semester = \"\", year = 0) {\r\n\r\n        const body = { userid: userid, semester: semester, year: year };\r\n\r\n        return await this.sendPost(\"/forms/by-semester-year\", body);\r\n\r\n        //To use this data you must do the following:\r\n        //api.getAllForms(userid, semester, year).then(courses => {/*here is where the data is accessible, forms is an array of JSON objects*/})\r\n    }\r\n\r\n    //---postForm(userId, year, semester, department, courseNumber, sectionNumber, isSectionCompleted, outcomes, ITGrades, CSGrades, CEGrades)---\r\n    //    Input: ^^^   (will also have pdf here later as an additional parameter)\r\n    //    Output: Success or Failure\r\n    async postForm(userId = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", sectionNumber = \"\", isSectionCompleted = false, outcomes = [], ITGrades = {}, CSGrades = {}, CEGrades = {}) {\r\n        // the body will also include any pdf to post in the future\r\n\r\n        //outcomes: an array of Course_Outcomes objects\r\n        //Course_Outcomes class:\r\n        //string outcome, int numberOfIT, int numberOfCS, int numberOfCE, StudentWorks[] studentWorks\r\n        //StudentWorks class:\r\n        //string studentWork, string fileUploaded (<-- will implement later)\r\n\r\n        //IT, CS, CE Grades class:\r\n        //int A, int B, int C, int D, int E, int F, int W, int I, int totalStudents\r\n\r\n        const body = {\r\n            form: {\r\n                section: {\r\n                    instructor: {\r\n                        id: userId\r\n                    },\r\n                    year,\r\n                    semester,\r\n                    department,\r\n                    courseNumber,\r\n                    sectionNumber,\r\n                    isSectionCompleted\r\n                },\r\n                outcomes,\r\n                ITGrades,\r\n                CSGrades,\r\n                CEGrades\r\n            }\r\n        };\r\n\r\n        return await this.sendPost(\"/forms/post-form\", body);\r\n    }\r\n\r\n    //---postComment(userId, year, semester, department, courseNumber, coordinatorComment, isCourseCompleted)---\r\n    //    Input: UserId, Year, Semester, department, courseNumber, coordinatorComment, isCourseCompleted\r\n    //    Output: Success or Failure\r\n    async postComment(userId = \"\", year = 0, semester = \"\", department = \"\", courseNumber = \"\", coordinatorComment = \"\", isCourseCompleted = false) {\r\n        const body = {\r\n            course: {\r\n                Coordinator: {\r\n                    Id: userId,\r\n                },\r\n                year,\r\n                semester,\r\n                department,\r\n                courseNumber,\r\n                coordinatorComment,\r\n                isCourseCompleted\r\n            }\r\n        };\r\n\r\n        return await this.sendPost(\"/courses/post-comment\", body);\r\n    }\r\n\r\n    //---getBlankForm(userid)---\r\n    //    Input: Section object containing: CourseNumber, SectionNumber, and Id\r\n    //    Output: Blank Form\r\n    //async getBlankForm(userid) {\r\n    async getBlankForm(courseNumber = \"\", sectionNumber = \"\", sectionId = 0) {\r\n        const body = { \r\n            Section: {\r\n                CourseNumber: courseNumber,\r\n                SectionNumber: sectionNumber,\r\n                Id: sectionId\r\n            }\r\n        };\r\n\r\n        return await this.sendPost(\"/forms/new-blank\", body);\r\n\r\n        //To use this data you must do the following:\r\n        //api.getBlankForm(userid).then(result => {/*here is where the return value is accessible, it is a JSON*/})\r\n    }\r\n\r\n    //--getDefaultYearAndSemester()--\r\n    //    Input: Nothing\r\n    //    Output: Object Including Current Default Year and Semester\r\n    getDefaultYearAndSemester() {\r\n        var text = '{ \"year\": 0,' +         // create string of object\r\n                   ' \"semester\": \"\" }';\r\n        var ResultObj = JSON.parse(text);   // create object from the string\r\n\r\n        var date = new Date();              // get the current date\r\n        var day = date.getDay();            // get the current day\r\n        var month = date.getMonth() + 1;    // add one to month (by default January = 0)\r\n        ResultObj.year = date.getFullYear();// get the full year from the date\r\n        ResultObj.semester = \"fall\";        // just to be safe\r\n        \r\n        // Set the Default Semester Based on the Month\r\n        if ((month > 8) || (month == 8 && day >= 15)) {\r\n            ResultObj.semester = \"fall\";\r\n        }\r\n        else if ((month > 5) || (month == 5 && day >= 15)) {\r\n            ResultObj.semester = \"summer\";\r\n            // since this is just a default semester, it always defaults to the longer semesters\r\n            // this is why it doesn't default to smaller summer semesters\r\n        }\r\n        else {\r\n            ResultObj.semester = \"spring\";\r\n        }\r\n\r\n        return ResultObj;    // return object including the year and semester\r\n    }\r\n\r\n    //---addSection(userid, firstName, lastName, year, semester, courseNumber, sectionNumber, department, numberOfStudents)--- (Admin)\r\n    //    Input: ^^^\r\n    //    Output: Success or Failure\r\n    async addSection(userid = \"\", firstName = \"\", lastName = \"\", year = 0, semester = \"\", courseNumber = \"\", sectionNumber = \"\", department = \"\", numberOfStudents = 0) {\r\n        const body = {\r\n            section: {\r\n                instructor: {\r\n                    id: userid,\r\n                    firstName,\r\n                    lastName\r\n                },\r\n                year,\r\n                semester,\r\n                courseNumber,\r\n                sectionNumber,\r\n                department,\r\n                isSectionCompleted: false,\r\n                numberOfStudents\r\n            }\r\n            \r\n        };\r\n\r\n        return await this.sendPost(\"/sections/add-section\", body);\r\n    }\r\n\r\n    //---getFacultyList()--- (Admin)\r\n    //    Input: none\r\n    //    Output: List of instructors, coordinators, adjunct faculties, and teaching fellows\r\n    async getFacultyList()\r\n    {\r\n        return await this.sendPost(\"/faculty/get-list\", {});\r\n    }\r\n    \r\n    //---addFacultyMember(firstName, lastName, userid, role)--- (Admin)\r\n    //    Input: First Name, Last Name and User Id\r\n    //    Output: Success or Failure\r\n    async addFacultyMember(firstName = \"\", lastName = \"\", userId = \"\", facultyType = \"\")\r\n    {\r\n        const body = \r\n        {\r\n            info: {\r\n                firstName: firstName,\r\n                lastName: lastName,\r\n                id: userId\r\n            },\r\n            facultyType: facultyType\r\n        };\r\n\r\n        return await this.sendPost(\"/faculty/add-member\", body);\r\n    }\r\n    \r\n    //---getCoursesByDepartment(department)--- (Admin)\r\n    //    Input: department\r\n    //    Output: array of courses\r\n    async getCoursesByDepartment(department = \"\") {\r\n        const body = {\r\n            department\r\n        };\r\n        \r\n        return await this.sendPost(\"/courses/get-by-department\", body);\r\n    }\r\n    \r\n    //---addProgram(program)--- (Admin)\r\n    //    Input: program name\r\n    //    Output: success or failure\r\n    async addProgram(program = \"\") {\r\n        const body = {\r\n            program\r\n        };\r\n        \r\n        return await this.sendPost(\"/programs/add-program\", body);\r\n    }\r\n    \r\n    //---addCourse(userid, firstName, lastName, year, semester, courseNumber, displayName, department)--- (Admin)\r\n    //    Input: ^^^\r\n    //    Output: success or failure\r\n    async addCourse(userid = \"\", firstName = \"\", lastName = \"\", year = 0, semester = \"\", courseNumber = \"\", displayName = \"\", department = \"\")\r\n    {\r\n        const body = {\r\n            Course: {\r\n                Coordinator: {\r\n                    Id: userid,\r\n                    firstName,\r\n                    lastName\r\n                },\r\n                year,\r\n                semester,\r\n                courseNumber,\r\n                displayName,\r\n                department\r\n            }\r\n        };\r\n        \r\n        return await this.sendPost(\"/courses/add-course\", body);\r\n    }\r\n    \r\n    //---removeCourse(year, semester, courseNumber, department)--- (Admin)\r\n    //    Input: year, semester, courseNumber, department\r\n    //    Output: success or failure\r\n    async removeCourse(year = 0, semester = \"\", courseNumber = \"\", department = \"\")\r\n    {\r\n        const body = {\r\n            Course: {\r\n                year,\r\n                semester,\r\n                courseNumber,\r\n                department\r\n            }\r\n        };\r\n        \r\n        return await this.sendPost(\"/courses/remove-course\", body);\r\n    }\r\n\r\n    //---getCourseOutcomesByCourse(year, semester, courseNumber, department)--- (Admin)\r\n    //    Input: year, semester, courseNumber, department\r\n    //    Output: array of course outcomes\r\n    async getCourseOutcomesByCourse(year = 0, semester = \"\", courseNumber = \"\", department = \"\")\r\n    {\r\n        const body = {\r\n            Course: {\r\n                year,\r\n                semester,\r\n                courseNumber,\r\n                department\r\n            }\r\n        };\r\n    \r\n        return await this.sendPost(\"/course-outcomes/by-course\", body);\r\n    }\r\n\r\n    //---postCourseOutcomes(outcomes)--- (Admin)\r\n    //    Input: array of outcome objects (see notes below)\r\n    //    Output: success or failure\r\n    async postCourseOutcomes(outcomes = [])\r\n    {\r\n        //an outcome object contains the following:\r\n        //order (number), outcome (string), mappedStudentOutcomes(array of numbers)\r\n        //Example:\r\n        //{\r\n        //    order: 1, outcome: \"Accomplish things\", mappedStudentOutcomes: [1, 0, 0, 1, 0, 1]\r\n        //}\r\n\r\n        const body = {\r\n            courseOutcomesList: outcomes\r\n        };\r\n    \r\n        return await this.sendPost(\"/course-outcomes/post-outcomes\", body);\r\n    }\r\n    \r\n    //---postSection(userid, firstName, lastName, year, semester, courseNumber, sectionNumber, department, numberOfStudents)--- (Instructor)\r\n    //   Input: Section object\r\n    //   Output: success or failure\r\n    async postSection(userid = \"\", year = 0, semester = \"\", courseNumber = \"\", sectionNumber = \"\", department = \"\", firstName = \"\", lastName = \"\", numberOfStudents = 0) {\r\n        const body = {\r\n            section: {\r\n                instructor: {\r\n                    id: userid,\r\n                    firstName,\r\n                    lastName\r\n                },\r\n                year,\r\n                semester,\r\n                courseNumber,\r\n                sectionNumber,\r\n                department,\r\n                isSectionCompleted: false,\r\n                NumberOfStudents\r\n            }\r\n\r\n        };\r\n\r\n        return await this.sendPost(\"/sections/post-section\", body);\r\n    }\r\n    \r\n    async uploadAccessDb(formData = new FormData()) \r\n    {\r\n        return await this.sendFile('/upload-access-db', formData);\r\n    }\r\n    \r\n    async uploadStudentWork(formData = new FormData(), outcomeId = 0, courseNumber = \"\", sectionNumber = \"\", semester = \"\", year = 0) \r\n    {\r\n        //outcomeId is a unique id that identifies a certain outcome in the DB\r\n        //it will come from the DB when the instructor form page is loaded\r\n\r\n        formData.append(\"outcomeId\", outcomeId);\r\n        formData.append(\"courseNumber\", courseNumber);\r\n        formData.append(\"sectionNumber\", sectionNumber);\r\n        formData.append(\"semester\", semester);\r\n        formData.append(\"year\", year);\r\n        return await this.sendFile('/student-work/upload', formData);\r\n    }\r\n\r\n    async downloadStudentWork(fileId = \"\", fileName = \"\") {\r\n        //fileId is the unique file name given to a file when it is uploaded\r\n        //fileName is the original file name the file had before it was uploaded\r\n        //both of these values will come from the DB when the instructor form page is loaded\r\n    \r\n        return await this.sendPost(\"/student-work/download\", { fileId }, true, fileName);\r\n    }\r\n}\r\n\r\nclass ErrorObj {\r\n    constructor(message = \"\", isLoggedIn = true) {\r\n        this.failure = true;\r\n        this.message = message;\r\n        this.isLoggedIn = isLoggedIn;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}